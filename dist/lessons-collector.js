!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://localhost:3002/",n(n.s=2)}([function(e,t,n){var r,o,a;o=[],void 0===(a="function"==typeof(r=function(){return function e(t,n,r){var o,a,i=window,u="application/octet-stream",l=r||u,s=t,c=!n&&!r&&s,f=document.createElement("a"),m=function(e){return String(e)},d=i.Blob||i.MozBlob||i.WebKitBlob||m,p=n||"download";if(d=d.call?d.bind(i):Blob,"true"===String(this)&&(l=(s=[s,l])[0],s=s[1]),c&&c.length<2048&&(p=c.split("/").pop().split("?")[0],f.href=c,-1!==f.href.indexOf(c))){var h=new XMLHttpRequest;return h.open("GET",c,!0),h.responseType="blob",h.onload=function(t){e(t.target.response,p,u)},setTimeout((function(){h.send()}),0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(s)){if(!(s.length>2096103.424&&d!==m))return navigator.msSaveBlob?navigator.msSaveBlob(b(s),p):w(s);l=(s=b(s)).type||u}else if(/([\x80-\xff])/.test(s)){for(var v=0,y=new Uint8Array(s.length),g=y.length;v<g;++v)y[v]=s.charCodeAt(v);s=new d([y],{type:l})}function b(e){for(var t=e.split(/[:;,]/),n=t[1],r=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),o=r.length,a=0,i=new Uint8Array(o);a<o;++a)i[a]=r.charCodeAt(a);return new d([i],{type:n})}function w(e,t){if("download"in f)return f.href=e,f.setAttribute("download",p),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===t&&setTimeout((function(){i.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,u)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,u)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=s instanceof d?s:new d([s],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(o,p);if(i.URL)w(i.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===m)try{return w("data:"+l+";base64,"+i.btoa(o))}catch(e){return w("data:"+l+","+encodeURIComponent(o))}(a=new FileReader).onload=function(e){w(this.result)},a.readAsDataURL(o)}return!0}})?r.apply(t,o):r)||(e.exports=a)},,function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"fileNameNormalize",value:function(e){var t=e.trim().split(""),n={"\\":"_","/":"_",":":"-","*":"_","?":"7",'"':"'","<":"{",">":"}","|":" l "};return(t=t.map((function(e){return n[e]||e}))).join("")}},{key:"fileNameExt",value:function(e){var t=e.match(/.*(\.\w*)/i);return t&&t[1]}},{key:"blob2base64",value:function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){return t(e.target.result)},n.readAsDataURL(e)}))}},{key:"StrBytes",value:function(e){var t,n,r,o=0,a=e.length;for(r=0;r<a;r++)(t=e.charCodeAt(r))>=55296&&t<57344&&t<56320&&r+1<a&&(n=e.charCodeAt(r+1))>=56320&&n<57344?(o+=4,r++):o+=t<128?1:t<2048?2:3;return o}},{key:"Percent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(0===t)return(0).toFixed(n);var r=100*e/t;return r.toFixed(n)}},{key:"FileSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=+e,isNaN(e))return!1;var n=0,r=["Б","КБ","МБ","ГБ","ТБ"];function o(e){return e>1024&&n<4?(n++,o(e/1024)):e}return t?{size:o(e),level:n,unit:r[n]}:"".concat(o(e).toFixed(1)," ").concat(r[n])}},{key:"UrlParse",value:function(e){var t={},n=e.match(/(http\:\/\/|https\:\/\/|ftp\:\/\/)(.*?\..*?\/)(.*\/)*(.*)(\/.*\.(.*))*/i);if(t.schema=n[1],t.host=n[2],t.path=n[3].split("/"),t.path=t.path.filter((function(e){return e.length>0})),n[4]){var r=n[4].split(".");if(r.length>1){var o=r.pop(),a=r.join(".");t.file={fileName:a+"."+o,name:a,ext:o}}else t.path.push(n[4])}return t}},{key:"TimeNormalizer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"!=typeof e||e<0)return!1;var r=[],o=e/1e3,a={},i={day:"д",hour:"ч",min:"мин",sec:"с",msec:"мс"},u={min:60,hour:3600,day:86400},l=!1;function s(e,t){t<=0&&!l||(l=!0,r.push({unit:i[e],value:t}))}var c=Math.floor(o/u.day);s("day",c),o-=c*u.day;var f=Math.floor(o/u.hour);s("hour",f),o-=f*u.hour;var m=Math.floor(o/u.min);s("min",m);var d=Math.floor(o%60);(!t&&!l||d>0)&&(l=!0,s("sec",d));var p=Math.round(1e3*(o%60-d));return a.msec=p,!t&&l||(l=!0,s("msec",p)),n?r:r.reduce((function(e,t,n){return e+"".concat(n>0?" ":"").concat(t.value).concat(t.unit)}),"")}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.default_val=n,this.init()}var t,n,r;return t=e,(n=[{key:"set",value:function(e,t){if(void 0===t)return!1;var n=JSON.parse(localStorage.getItem(this.name));return n[e]=t,localStorage.setItem(this.name,JSON.stringify(n)),n}},{key:"get",value:function(e){return JSON.parse(localStorage.getItem(this.name))[e]}},{key:"getAll",value:function(){return JSON.parse(localStorage.getItem(this.name))}},{key:"remove",value:function(e){var t=JSON.parse(localStorage.getItem(this.name));return delete t[e],localStorage.setItem(this.name,JSON.stringify(t)),t}},{key:"clear",value:function(){localStorage.removeItem(this.name),this.prepareStorage()}},{key:"prepareStorage",value:function(){return null==localStorage.getItem(this.name)&&(localStorage.setItem(this.name,JSON.stringify(this.default_val)),!0)}},{key:"init",value:function(){this.prepareStorage()}}])&&u(t.prototype,n),r&&u(t,r),e}();function s(e,t,n,r,o,a,i){try{var u=e[a](i),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,u,"next",e)}function u(e){s(a,r,o,i,u,"throw",e)}i(void 0)}))}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,a;return t=e,n=null,r=[{key:"collectLessonsData",value:(a=c(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelector("#lessons-list"),r=n.querySelectorAll(".lessons-item"),o=[],r.forEach((function(e,n){var r=t.get(n),a={index:n,name_prefix:i.fileNameNormalize(e.querySelector('[itemprop="name"]').textContent),name_concat:" ",lesson_name:i.fileNameNormalize(e.querySelector(".lessons-name").textContent),storage_name:n,url:e.querySelector('[itemprop="url"]').href,ext:i.UrlParse(e.querySelector('[itemprop="url"]').href).file.ext,content:null,mime:null,total:r?+r:0,loaded:r?+r:0,percent:r?100:0,is_checked:!0,is_loading:!1,is_loaded:!!r,was_loaded:!!r};o.push(a)})),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"collectMaterials",value:(o=c(regeneratorRuntime.mark((function e(t,n,r){var o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=document.querySelector('[title="Download course materials"]')){e.next=3;break}return e.abrupt("return",!1);case 3:return a=t.get("code"),u={index:n,name_prefix:"Материалы курса",name_concat:" - ",lesson_name:i.fileNameNormalize(r),storage_name:"code",url:o.href,ext:i.UrlParse(o.href).file.ext,content:null,mime:null,total:a?+a:0,loaded:a?+a:0,percent:a?100:0,is_checked:!0,is_loading:!1,is_loaded:!!a,was_loaded:!!a},e.abrupt("return",u);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}],n&&f(t.prototype,n),r&&f(t,r),e}();function d(e,t,n,r,o,a,i){try{var u=e[a](i),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){d(a,r,o,i,u,"next",e)}function u(e){d(a,r,o,i,u,"throw",e)}i(void 0)}))}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(){var t,n,r,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n="collectLessons",r=p(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(t=i.UrlParse(document.location.href)).path.pop(),a.setCourseName(t),a.storage=new l(t,{}),n=document.querySelector("h1.hero-title").textContent,a.setCourseDisplayName(n),e.next=8,a.collectLessonItems();case 8:return e.next=10,a.collectMaterials();case 10:o()(JSON.stringify(a.json," ",4),"".concat(i.fileNameNormalize(n),".json"),"application/json");case 11:case"end":return e.stop()}}),e)}))),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.json={course_name:"",course_display_name:"",lesson_items:[]},this.storage=null,this.init()}var t,n,r,a,u;return t=e,(n=[{key:"createBtn",value:function(){this.btn=document.createElement("button"),this.btn.className="btn mt-20 ml-20",this.btn.textContent="Скачать json с уроками",this.btn.addEventListener("click",this.collectLessons),document.querySelector("#lessons-toggle").after(this.btn)}},{key:"collectLessonItems",value:(u=p(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collectLessonsData(this.storage);case 2:(t=e.sent)&&(t.forEach((function(e){return n.addItem(e)})),this.storage.set("cnt",this.cnt));case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"collectMaterials",value:(a=p(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.collectMaterials(this.storage,this.cnt,this.getCourseDisplayName);case 3:(t=e.sent)&&this.addItem(t),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return a.apply(this,arguments)})},{key:"addItem",value:function(e){this.json.lesson_items.push(e)}},{key:"setCourseName",value:function(e){this.json.course_name=e}},{key:"setCourseDisplayName",value:function(e){this.json.course_display_name=e}},{key:"init",value:function(){this.createBtn()}},{key:"destroy",value:function(){this.btn.remove()}},{key:"cnt",get:function(){return this.json.lesson_items.length}},{key:"getCourseDisplayName",get:function(){return this.json.course_display_name}}])&&h(t.prototype,n),r&&h(t,r),e}();window.lessonsCollector=new v}]);